
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Algorithm &#8212; PyBerny 0.6.2.post14.dev0+4b6d042 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="Getting started" href="getting-started.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyBerny</a></h1>



<p class="blurb">Molecular/crystal structure optimizer</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jhrmnn&repo=pyberny&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jhrmnn/pyberny">
    <img
        alt="https://secure.travis-ci.org/jhrmnn/pyberny.svg?branch=master"
        src="https://secure.travis-ci.org/jhrmnn/pyberny.svg?branch=master"
    />
</a>
</p>




    

<p>
<a class="badge" href="https://codecov.io/github/jhrmnn/pyberny">
    <img
    alt="https://codecov.io/github/jhrmnn/pyberny/coverage.svg?branch=master"
    src="https://codecov.io/github/jhrmnn/pyberny/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sketch-of-the-algorithm">Sketch of the algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#redundant-internal-coordinates">Redundant internal coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generalized-inverse">Generalized inverse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="getting-started.html" title="previous chapter">Getting started</a></li>
      <li>Next: <a href="api.html" title="next chapter">API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="algorithm">
<h1>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h1>
<p>The optimization algorithm implemented in PyBerny loosely follows the
“standard method” (SM) described in the appendix of <a class="reference internal" href="#birkholztca16" id="id1"><span>[BirkholzTCA16]</span></a>. What
follows is a summary of that method, more detailed specification when
necessary, and description of any deviations.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Make the algorithm <a class="reference external" href="https://github.com/jhrmnn/pyberny/issues/29">fully conform</a> to the SM.</p>
</div>
<div class="section" id="sketch-of-the-algorithm">
<h2>Sketch of the algorithm<a class="headerlink" href="#sketch-of-the-algorithm" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Form <a class="reference internal" href="#redundant-internal-coordinates">redundant internal coordinates</a>.</p></li>
<li><p>Form a diagonal Hessian guess <a class="reference internal" href="#swartijqc06" id="id3"><span>[SwartIJQC06]</span></a>.</p></li>
<li><p>Obtain energy and Cartesian gradients for the current geometry.</p></li>
<li><p>Form the Wilson <strong>B</strong> matrix and its <a class="reference internal" href="#generalized-inverse">generalized inverse</a>.</p></li>
<li><p>Update the Hessian using the BFGS scheme.</p></li>
<li><p>Update trust region (Eq. 5.1.6 of <a class="reference internal" href="#fletcher00" id="id4"><span>[Fletcher00]</span></a>).</p></li>
<li><p>Perform linear search (Gaussian <a class="reference external" href="http://gaussian.com/opt/">website</a>,
section Examples, “If a minimum is sought…”). (Not in the SM.)</p></li>
<li><p>Project to a nonredundant subspace <a class="reference internal" href="#pengjcc96" id="id5"><span>[PengJCC96]</span></a>.</p></li>
<li><p>Perform a quadratic RFO step <a class="reference internal" href="#banerjeejpc85" id="id6"><span>[BanerjeeJPC85]</span></a>.</p></li>
<li><p>Transform back to Cartesian coordinates <a class="reference internal" href="#pengjcc96" id="id7"><span>[PengJCC96]</span></a>.</p></li>
<li><p>If convergence is not reached (criteria from the SM), go to 3.</p></li>
</ol>
</div>
<div class="section" id="redundant-internal-coordinates">
<h2>Redundant internal coordinates<a class="headerlink" href="#redundant-internal-coordinates" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>All bonds shorter than 1.3 times the sum of covalent radii are created
<a class="reference internal" href="#pengjcc96" id="id8"><span>[PengJCC96]</span></a>.</p></li>
<li><p>If there are unconnected fragments, all bonds between unconnected fragments
shorter than the sum of van der Waals radii plus <em>d</em> are created, with <em>d</em>
starting at 0 and increasing by 1 angstrom, until all fragments are
connected (custom scheme by JH).</p></li>
<li><p>All angles greater than 45° are created.</p></li>
<li><p>All dihedrals with 1–2–3, 2–3–4 angles both greater than 45° are created. If
one of the angles is zero, so that three atoms lie on a line, they are used
as a new base for a dihedral. This process is recursively repeated
<a class="reference internal" href="#pengjcc96" id="id9"><span>[PengJCC96]</span></a>.</p></li>
<li><p>In the case of a crystal, just the internal coordinate closest to the
original unit cell is retained from all its periodic images.</p></li>
</ol>
<div class="admonition-todo admonition" id="id10">
<p class="admonition-title">Todo</p>
<p>Implement <a class="reference external" href="https://github.com/jhrmnn/pyberny/issues/30">linear bends</a>.</p>
</div>
</div>
<div class="section" id="generalized-inverse">
<h2>Generalized inverse<a class="headerlink" href="#generalized-inverse" title="Permalink to this headline">¶</a></h2>
<p>The Wilson <strong>B</strong> matrix, which relates differences in the internal redundant
coordinates to differences in the Cartesian coordinates, is in general
non-square and non-invertible. Its generalized inverse is obtained from the
pseudoinverse of <span class="math">\(\mathbf B\mathbf B^\mathrm T\)</span> (singular), which is in
turn obtained via singular value decomposition and inversion of only the
nonzero singular values. For invertible matrices, this procedure is equivalent
to an ordinary inverse. In practice, the zero values are in fact nonzero but
several orders of magnitude smaller than the true nonzero values.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="birkholztca16"><span class="brackets"><a class="fn-backref" href="#id1">BirkholzTCA16</a></span></dt>
<dd><p>Birkholz, A. B. &amp; Schlegel, H. B. Exploration of some
refinements to geometry optimization methods. Theor. Chem. Acc. 135, (2016).
DOI: <a class="reference external" href="http://dx.doi.org/10.1007/s00214-016-1847-3">10.1007/s00214-016-1847-3</a></p>
</dd>
<dt class="label" id="pengjcc96"><span class="brackets">PengJCC96</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id7">2</a>,<a href="#id8">3</a>,<a href="#id9">4</a>)</span></dt>
<dd><p>Peng, C., Ayala, P. Y., Schlegel, H. B. &amp; Frisch, M. J. Using
redundant internal coordinates to optimize equilibrium geometries and
transition states. J. Comput. Chem. 17, 49–56 (1996). DOI:
<a class="reference external" href="https://doi.org/10.1002/(SICI)1096-987X(19960115)17:1&lt;49::AID-JCC5&gt;3.0.CO;2-0">10.1002/(SICI)1096-987X(19960115)17:1&lt;49::AID-JCC5&gt;3.0.CO;2-0</a></p>
</dd>
<dt class="label" id="swartijqc06"><span class="brackets"><a class="fn-backref" href="#id3">SwartIJQC06</a></span></dt>
<dd><p>Swart, M. &amp; Bickelhaupt, F. M. Optimization of Strong and Weak
Coordinates. Int. J. Quantum Chem. 106, 2536–2544 (2006). DOI:
<a class="reference external" href="https://doi.org/10.1002/qua.21049">10.1002/qua.21049</a></p>
</dd>
<dt class="label" id="fletcher00"><span class="brackets"><a class="fn-backref" href="#id4">Fletcher00</a></span></dt>
<dd><p>Fletcher, R. Practical Methods of Optimization. (Wiley, 2000).
URL:
<a class="reference external" href="https://www.wiley.com/en-us/Practical+Methods+of+Optimization%2C+2nd+Edition-p-9780471494638">https://www.wiley.com/en-us/Practical+Methods+of+Optimization%2C+2nd+Edition-p-9780471494638</a></p>
</dd>
<dt class="label" id="banerjeejpc85"><span class="brackets"><a class="fn-backref" href="#id6">BanerjeeJPC85</a></span></dt>
<dd><p>Banerjee, A., Adams, N. &amp; Simons, J. Search for Stationary
Points on Surfaces. J. Phys. Chem. 57, 52–57 (1985). DOI:
<a class="reference external" href="https://doi.org/10.1021/j100247a015">10.1021/j100247a015</a></p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2016-2021, Jan Hermann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/algorithm.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>