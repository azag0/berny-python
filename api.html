
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API &#8212; PyBerny 0.6.2.post13.dev0+d535ad3 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Algorithm" href="algorithm.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyBerny</a></h1>



<p class="blurb">Molecular/crystal structure optimizer</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jhrmnn&repo=pyberny&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jhrmnn/pyberny">
    <img
        alt="https://secure.travis-ci.org/jhrmnn/pyberny.svg?branch=master"
        src="https://secure.travis-ci.org/jhrmnn/pyberny.svg?branch=master"
    />
</a>
</p>




    

<p>
<a class="badge" href="https://codecov.io/github/jhrmnn/pyberny">
    <img
    alt="https://codecov.io/github/jhrmnn/pyberny/coverage.svg?branch=master"
    src="https://codecov.io/github/jhrmnn/pyberny/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#geometry-operations">Geometry operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solvers">Solvers</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="algorithm.html" title="previous chapter">Algorithm</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p>This covers all supported public API.</p>
<span class="target" id="module-berny"></span><dl class="py class">
<dt id="berny.Berny">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">berny.</span></code><code class="sig-name descname"><span class="pre">Berny</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/berny.html#Berny"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Berny" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator that receives energy and gradients and yields the next geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geom</strong> (<a class="reference internal" href="#berny.Geometry" title="berny.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>) – geometry to start with</p></li>
<li><p><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>, the generator yields debug info on receiving
the energy and gradients, otherwise it yields <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a></p></li>
<li><p><strong>restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – start from a state saved from previous run
using <code class="docutils literal notranslate"><span class="pre">debug=True</span></code></p></li>
<li><p><strong>maxsteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – abort after maximum number of steps</p></li>
<li><p><strong>logger</strong> (<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a>) – alternative logger to use</p></li>
<li><p><strong>params</strong> – parameters that override the <a class="reference internal" href="#berny.berny.defaults" title="berny.berny.defaults"><code class="xref py py-data docutils literal notranslate"><span class="pre">defaults</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>The Berny object is to be used as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">Berny</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
<span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">optimizer</span><span class="p">:</span>
    <span class="c1"># calculate energy and gradients (as N-by-3 matrix)</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="n">energy</span><span class="p">,</span> <span class="n">gradients</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt id="berny.Berny.converged">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">converged</span></code><a class="headerlink" href="#berny.Berny.converged" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the optimized has converged.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Berny.trust">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">trust</span></code><a class="headerlink" href="#berny.Berny.trust" title="Permalink to this definition">¶</a></dt>
<dd><p>Current trust radius.</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt id="berny.berny.defaults">
<code class="sig-prename descclassname"><span class="pre">berny.berny.</span></code><code class="sig-name descname"><span class="pre">defaults</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'dihedral':</span> <span class="pre">True,</span> <span class="pre">'gradientmax':</span> <span class="pre">0.00045,</span> <span class="pre">'gradientrms':</span> <span class="pre">0.00015,</span> <span class="pre">'stepmax':</span> <span class="pre">0.0018,</span> <span class="pre">'steprms':</span> <span class="pre">0.0012,</span> <span class="pre">'superweakdih':</span> <span class="pre">False,</span> <span class="pre">'trust':</span> <span class="pre">0.3}</span></em><a class="headerlink" href="#berny.berny.defaults" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">gradientmax</span></code>, <code class="docutils literal notranslate"><span class="pre">gradientrms</span></code>, <code class="docutils literal notranslate"><span class="pre">stepmax</span></code>, <code class="docutils literal notranslate"><span class="pre">steprms</span></code></dt><dd><p>Convergence criteria in atomic units (“step” refers to the step in
internal coordinates, assuming radian units for angles).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">trust</span></code></dt><dd><p>Initial trust radius in atomic units. It is the maximum RMS of the
quadratic step (see below).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dihedral</span></code></dt><dd><p>Form dihedral angles.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">superweakdih</span></code></dt><dd><p>Form dihedral angles containing two or more noncovalent bonds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt id="berny.coords.angstrom">
<code class="sig-prename descclassname"><span class="pre">berny.coords.</span></code><code class="sig-name descname"><span class="pre">angstrom</span></code><em class="property"> <span class="pre">=</span> <span class="pre">1.8897261245650618</span></em><a class="headerlink" href="#berny.coords.angstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Can be imported directly as <code class="xref py py-data docutils literal notranslate"><span class="pre">berny.angstrom</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="berny.optimize">
<code class="sig-prename descclassname"><span class="pre">berny.</span></code><code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/optimize.html#optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize a geometry with respect to a solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>) – Optimizer object with
the same generator interface as <a class="reference internal" href="#berny.Berny" title="berny.Berny"><code class="xref py py-class docutils literal notranslate"><span class="pre">Berny</span></code></a></p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>) – <p>unprimed generator that
receives geometry as a 2-tuple of a list of 2-tuples of the atom
symbol and coordinate (as a 3-tuple), and of a list of lattice
vectors (or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if molecule), and yields the energy and
gradients (as a <span class="math">\(N\)</span>-by-3 matrix or <span class="math">\((N+3)\)</span>-by-3 matrix
in case of a crystal geometry).</p>
<p>See <a class="reference internal" href="#berny.solvers.MopacSolver" title="berny.solvers.MopacSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">MopacSolver</span></code></a> for an example.</p>
</p></li>
<li><p><strong>trajectory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – filename for the XYZ trajectory</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The optimized geometry.</p>
</dd>
</dl>
<p>The function is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
<span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">optimizer</span><span class="p">:</span>
    <span class="n">energy</span><span class="p">,</span> <span class="n">gradients</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="n">geom</span><span class="p">),</span> <span class="n">geom</span><span class="o">.</span><span class="n">lattice</span><span class="p">))</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="n">energy</span><span class="p">,</span> <span class="n">gradients</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="geometry-operations">
<h2>Geometry operations<a class="headerlink" href="#geometry-operations" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="berny.Geometry">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">berny.</span></code><code class="sig-name descname"><span class="pre">Geometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a single molecule or a crystal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element symbols</p></li>
<li><p><strong>coords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of atomic coordinates in angstroms (as 3-tuples)</p></li>
<li><p><strong>lattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of lattice vectors (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> for a moleucle)</p></li>
</ul>
</dd>
</dl>
<p>Iterating over a geometry yields 2-tuples of symbols and coordinates.
<a class="reference external" href="https://docs.python.org/3/library/functions.html#len" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code></a> returns the number of atoms in a geometry. The class supports
<a class="reference external" href="https://docs.python.org/3/library/functions.html#format" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">format()</span></code></a> with the same available formats as <a class="reference internal" href="#berny.Geometry.dump" title="berny.Geometry.dump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump()</span></code></a>.</p>
<dl class="py method">
<dt id="berny.Geometry.bondmatrix">
<code class="sig-name descname"><span class="pre">bondmatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.bondmatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.bondmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the covalent connectedness matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – threshold for accepting a distance as a covalent bond</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math">\(b_{ij}:=R_{ij}&lt;\text{scale}\times (R_i^\text{cov}+R_j^\text{cov})\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.cms">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">cms</span></code><a class="headerlink" href="#berny.Geometry.cms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of mass, <span class="math">\(\mathbf R_\text{CMS}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the geometry.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.dist">
<code class="sig-name descname"><span class="pre">dist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for the first element of <a class="reference internal" href="#berny.Geometry.dist_diff" title="berny.Geometry.dist_diff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dist_diff()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.dist_diff">
<code class="sig-name descname"><span class="pre">dist_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.dist_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.dist_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate distances and vectors between atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#berny.Geometry" title="berny.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>) – calculate distances between two
geometries if given or within a geometry if not</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math">\(R_{ij}:=|\mathbf R_i-\mathbf R_j|\)</span> and
<span class="math">\(R_{ij\alpha}:=(\mathbf R_i)_\alpha-(\mathbf R_j)_\alpha\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.dump">
<code class="sig-name descname"><span class="pre">dump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the geometry into a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>file</em>) – file object</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – geometry format, one of <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;xyz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;aims&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;mopac&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.dumps">
<code class="sig-name descname"><span class="pre">dumps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#berny.Geometry.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the geometry represented as a string, delegates to <a class="reference internal" href="#berny.Geometry.dump" title="berny.Geometry.dump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.formula">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">formula</span></code><a class="headerlink" href="#berny.Geometry.formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Chemical formula of the molecule or a unit cell.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.from_atoms">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">from_atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.from_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.from_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative contructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of 2-tuples with an elemnt symbol and
a coordinate</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – value to multiple atomic coordiantes with</p></li>
<li><p><strong>lattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of lattice vectors (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> for a moleucle)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.inertia">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">inertia</span></code><a class="headerlink" href="#berny.Geometry.inertia" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the moment of inertia.</p>
<div class="math">
\[I_{\alpha\beta}:=
\sum_im_i\big(r_i^2\delta_{\alpha\beta}-(\mathbf r_i)_\alpha(\mathbf
r_i)_\beta\big),\qquad
\mathbf r_i=\mathbf R_i-\mathbf R_\text{CMS}

\]</div>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.masses">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">masses</span></code><a class="headerlink" href="#berny.Geometry.masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array of atomic masses.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.rho">
<code class="sig-name descname"><span class="pre">rho</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a measure of covalentness.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><span class="math">\(\rho_{ij}:=\exp\big(-R_{ij}/(R_i^\text{cov}+R_j^\text{cov})\big)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.super_circum">
<code class="sig-name descname"><span class="pre">super_circum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.super_circum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.super_circum" title="Permalink to this definition">¶</a></dt>
<dd><p>Supercell dimensions such that the supercell circumsribes a sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – circumscribed radius in angstroms</p>
</dd>
</dl>
<p>Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> when geometry is not a crystal.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.supercell">
<code class="sig-name descname"><span class="pre">supercell</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">((-</span> <span class="pre">1,</span> <span class="pre">1),</span> <span class="pre">(-</span> <span class="pre">1,</span> <span class="pre">1),</span> <span class="pre">(-</span> <span class="pre">1,</span> <span class="pre">1))</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a crystal supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of 2-tuples specifying the range of multiples
of the unit-cell vectors</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – if given, the ranges are determined such that
the supercell contains a sphere with the radius qual to the cutoff</p></li>
</ul>
</dd>
</dl>
<p>Returns a copy of itself when geometry is not a crystal.</p>
</dd></dl>

<dl class="py method">
<dt id="berny.Geometry.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#Geometry.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.Geometry.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the geometry into a file, delegates to <a class="reference internal" href="#berny.Geometry.dump" title="berny.Geometry.dump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – path that will be overwritten</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-berny.geomlib"></span><dl class="py function">
<dt id="berny.geomlib.load">
<code class="sig-prename descclassname"><span class="pre">berny.geomlib.</span></code><code class="sig-name descname"><span class="pre">load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.geomlib.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a geometry from a file object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>file</em>) – file object</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the format of the geometry file, can be one of <code class="docutils literal notranslate"><span class="pre">&quot;xyz&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;aims&quot;</span></code></p></li>
</ul>
</dd>
</dl>
<p>Returns <a class="reference internal" href="#berny.Geometry" title="berny.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt id="berny.geomlib.loads">
<code class="sig-prename descclassname"><span class="pre">berny.geomlib.</span></code><code class="sig-name descname"><span class="pre">loads</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#loads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.geomlib.loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a geometry from a string, delegates to <a class="reference internal" href="#berny.geomlib.load" title="berny.geomlib.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – string with geometry</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="berny.geomlib.readfile">
<code class="sig-prename descclassname"><span class="pre">berny.geomlib.</span></code><code class="sig-name descname"><span class="pre">readfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/geomlib.html#readfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.geomlib.readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a geometry from a file path, delegates to <a class="reference internal" href="#berny.geomlib.load" title="berny.geomlib.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – path to a geometry file</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – if not given, the format is given from the file extension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="solvers">
<h2>Solvers<a class="headerlink" href="#solvers" title="Permalink to this headline">¶</a></h2>
<p>All functions in this module are coroutines that satisfy the solver interface
expected by <a class="reference internal" href="#berny.optimize" title="berny.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.</p>
<span class="target" id="module-berny.solvers"></span><dl class="py function">
<dt id="berny.solvers.MopacSolver">
<code class="sig-prename descclassname"><span class="pre">berny.solvers.</span></code><code class="sig-name descname"><span class="pre">MopacSolver</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mopac'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PM7'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/berny/solvers.html#MopacSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#berny.solvers.MopacSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Crate a solver that wraps <a class="reference external" href="http://openmopac.net">MOPAC</a>.</p>
<p>Mopac needs to be installed on the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmd</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – MOPAC executable</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – model to calculate energy</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2016-2021, Jan Hermann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>